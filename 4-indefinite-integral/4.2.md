# 4.2 换元求积分

## 4.2.1 第一类换元法（凑微分）

### 一阶微分不变性和第一类换元法


如果 $F(u)$ 可导，$u = \phi (x)$ 可导，对 $u$ 微分 $dF(x) = F'(u)/,du$，对 $x$ 微分 $dF(x) = F'[\phi (x)] \phi '(x)\,dx$，两者相等。

对上述两式分别积分，得到 $\int F'(u)\,du = \int F'[\phi '(x)] \phi '(x)\,dx = F(u) + c$

由此可以推出，$\int g(x)\,dx$ 中 $g(x) = f[\phi (x)] \cdot \phi '(x)$ 且 $f(u)$ 有一个原函数 $F(u)$，则有：

$$
\begin{align}
\int g(x)\,dx & = \int f[\phi (x)] \cdot \phi '(x)\,dx \\\\
& = \int f[\phi (x)]\,d \phi(x) \\\\
& = F[\phi (x)] + c
\end{align}
$$

?> 由于 $\phi '(x)\,dx = d\phi (x)$、通过找出这个等式从而化简函数，降低积分难度，所以这个方法叫做「凑微分」。

### 常见凑微分形式

一般的，对于一次线性代数积分，都有

$$
\int f(ax + b)\,dx = \cfrac{1}{a}\,\int f(ax + b)\,d(ax + b) = \cfrac{1}{a} F(ax + b) + c
$$

其它的常见凑微分形式参见 [4.b 常见凑微分形式表](4-indefinite-integral/4.b)

## 4.2.2 第二类换元法

换元法即令 $t = \phi (x)$ 替换原函数中的部分，并通过这个等式找出 $t = \phi^{-1} (x)$（反函数逆运算以便最后回代）和 $dx = d \phi ' (t)dt$ 求出 $dx$ 用于一并代入。

基本步骤如下：

- 不定积分式为 $\int f(x) dx$
- 令 $x = \phi(t)$，则 $t = \phi ^{-1} (t)$
- 此时 $dx = d \phi (t) = \phi ' (t) dt$
- 代入积分式中得到 $\int f [\phi (t)] \phi ' (t) dt$
- 积分得到原函数 $F(t) + c$
- 将第 2 步中得到的 $x$ 与 $t$ 的关系式回代

?> 第二类换元法的定理如下：$f(x)$ 在 $(a, b)$ 上连续，$x = \phi (t)$ **单调可导**，则有 $\int f(x) d(x) = \{ \int f[\phi (t)]\phi '(t) dt \}_{t = \phi^{-1}(x)}$

### 无理代换

无理代换的目的是 **消去简单根式**。通过令 $t = \sqrt[n]{ax + b}$ 或者 $t = \sqrt[v]{\cfrac{ax + b}{cx + d}}$ 将整个根式整体代还去掉根式。

如果存在多个 根指数 不同的根式，需要取 根指数 的最小公倍数，这样换元后可以把所有的简单根式消去。

### 三角代换

面对含有以下根式特征的函数，可以通过三角恒等式进行化简：

?> 这里用到的三角恒等式有：$\sin^2 + \cos^2 = 1$ 和 $\sec^2 - \tan^2 = 1$

| 根式特征 |  | 对应三角函数等式 | 换元 |
|:---:|:---:|:---:|:---:|
| $\sqrt{a^2 - x^2}$ | $a^2 - x^2 = {?}^2$ | $a^2 - a^2 \sin ^2 t = a^2 \cos ^2 t$ | $x = a \sin t$ |
| $\sqrt{x^2 + a^2}$ | $x^2 + a^2 = {?}^2$ | $a^2 \tan ^2 t + a^2 = a^2 \sec ^2 t$ | $x = a \tan t$ |
| $\sqrt{x^2 - a^2}$ | $x^2 - a^2 = {?}^2$ | $a^2 \sec ^2 t - a^2 = a^2 \tan ^2 t$ | $x = a \sec t$ |

在回代的时候可以通过画一个 $Rt \Delta$（即辅助三角形），将 $t$ 视为一个锐角，使用勾股定理，可以较快地表示出 $a$ $x$ 与第三条边和 $t$ 之间的关系，从而将带 $t$ 的三角函数转换成 $a$ 和 $x$。

通过这个表格可以推出三个不定积分形式，可以在 [4.a 常见不定积分表](4-indefinite-integral/4.a) 查看。

!> 在遇到第三种形式的根式的时候，必须要考虑 $x > a$ 和 $x < -a$ 两种情况，这个时候可以先算第一种情况得出结论，再在第二种情况下通过转化为和第一种情况相近的形式，因此可以得到相同的结论，即是讨论完毕。

### 倒代换

如果分母次数较大，可以先令 $x = \cfrac{1}{t}$ 先给分母降幂、给分子升幂，然后再用之前的换元法进行二次换元得出最后的结果，然后需要回代两次得到最终结果。
